<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seu F√≥rum Moderno - Demonstra√ß√£o Interativa</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Configura√ß√£o da fonte Inter e anima√ß√µes globais */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #2170c0; /* Fundo mais claro e suave (slate-100) */
            padding-top: 6rem; /* Espa√ßo para o header fixo */
        }
        
        /* Classe para o header fixo com sombra mais forte */
        #fixed-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            background-color: rgb(255, 255, 255);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); /* Sombra mais profunda */
        }

        /* Estilo para anima√ß√£o de transi√ß√£o de conte√∫do: Inicia invis√≠vel e desativado */
        .content-section {
            opacity: 0;
            max-height: 0;
            overflow: hidden;
            transition: opacity 0.5s ease-in-out, max-height 0s 0.5s;
            padding: 0;
        }

        /* Classe ativa: Torna vis√≠vel e permite a altura total do conte√∫do */
        .content-section.active {
            max-height: 5000px; 
            transition: opacity 0.5s ease-in-out, max-height 0s 0s;
            opacity: 1;
            padding-top: 1.5rem; 
            padding-bottom: 1.5rem;
        }

        /* Adicionado para anima√ß√£o de novos t√≥picos */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeIn {
            animation: fadeIn 0.5s ease-out forwards;
        }

        /* Aprimoramento visual: Categoria em formato de p√≠lula */
        .category-pill {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem; /* text-xs */
            font-weight: 600; /* font-semibold */
            color: white;
            transition: background-color 0.2s ease-in-out;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        /* Cores mais vibrantes para as categorias */
        .Programa√ß√£o-Web { background-color: #4f46e5; } /* indigo-600 */
        .Design-UX/UI { background-color: #10b981; } /* emerald-500 */
        .Intelig√™ncia-Artificial { background-color: #ef4444; } /* red-500 */
        .Geral { background-color: #64748b; } /* slate-500 */
        
        /* Hover e foco para bot√µes principais */
        .primary-button {
            transition: all 0.3s ease-in-out;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.05);
        }
        .primary-button:hover {
             box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

    </style>
</head>
<body class="text-slate-800 flex flex-col min-h-screen">

    <header id="fixed-header" class="w-full">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
            <div class="text-3xl font-extrabold text-indigo-700">
                <span class="inline-block p-2 rounded-xl bg-indigo-100 mr-2">
                    <svg class="w-7 h-7 text-indigo-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.105A9.854 9.854 0 013 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path></svg>
                </span>
                
           F√ìRUM SPACE
            </div>

            <nav class="flex space-x-4" id="main-nav">
                <button data-target="home-content" class="nav-link text-sm font-semibold px-4 py-2 rounded-lg transition duration-150 ease-in-out hover:bg-indigo-50 hover:text-indigo-700 text-indigo-700 font-bold active-nav">
                    In√≠cio
                </button>
                <button data-target="profile-content" class="nav-link text-sm font-semibold px-4 py-2 rounded-lg transition duration-150 ease-in-out hover:bg-indigo-50 hover:text-indigo-700 text-slate-600">
                    Perfil
                </button>
            </nav>

            <div class="flex items-center space-x-3">
                
                <div id="auth-buttons" class="flex space-x-3">
                    <button data-target="login-content" class="nav-link text-slate-600 hover:text-indigo-600 text-sm font-medium py-2 px-2 rounded-lg transition duration-150 ease-in-out">
                        Login
                    </button>
                    <button data-target="register-content" class="nav-link primary-button bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-[1.05] active:scale-[0.98]">
                        üöÄ Cadastro
                    </button>
                </div>

                <div id="user-info" class="flex items-center space-x-4 hidden">
                    <button id="create-topic-button" data-target="create-topic-content" class="nav-link primary-button bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-[1.05] active:scale-[0.98]">
                        ‚ûï Novo T√≥pico
                    </button>
                    <div class="hidden sm:flex items-center space-x-2">
                        <span class="text-sm text-slate-600">Ol√°, <strong id="logged-user-name" class="text-indigo-700">Usu√°rio!</strong></span>
                        <img src="https://placehold.co/32x32/4f46e5/ffffff?text=U" alt="Avatar" class="w-8 h-8 rounded-full border border-indigo-300">
                    </div>
                    <button id="logout-button" class="bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded-full shadow-md transition duration-300 ease-in-out text-sm">
                        Sair
                    </button>
                </div>

            </div>
        </div>
    </header>

    <main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">

            <section class="lg:col-span-3"> 
                
                <section id="home-content" class="content-section active mt-6">
                    <h2 class="text-4xl font-extrabold mb-8 text-slate-900 border-b-2 pb-3 border-indigo-100">forum space</h2>
                    
                    <div class="bg-indigo-50 p-6 rounded-2xl shadow-xl mb-8 border border-indigo-200 transform hover:scale-[1.01] transition duration-300">
                        <h3 class="text-2xl font-bold text-indigo-700 mb-3"> Destaque da semana</h3>
                        <p class="text-indigo-800 mb-4 opacity-90">Aprenda os fundamentos e as aplica√ß√µes pr√°ticas das √∫ltimas tecnologias de Intelig√™ncia Artificial, de Large Language Models a Vis√£o Computacional. Junte-se √† conversa e n√£o fique para tr√°s!</p>
                        <button class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-6 rounded-full text-sm shadow-md primary-button">
                            Ver T√≥pico Completo &rarr;
                        </button>
                    </div>
                    
                    <h3 class="text-3xl font-bold mb-6 text-slate-700">T√≥picos Recentes</h3>
                    
                    <div id="topics-list-container" class="space-y-4">
                        </div>
                </section>

                <section id="topic-detail-content" class="content-section">
                    <button onclick="setActiveContent('home-content'); setNavActiveByTarget('home-content')" class="text-indigo-600 hover:text-indigo-800 font-medium mb-4 flex items-center">
                        <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>
                        Voltar aos T√≥picos
                    </button>
                    
                    <div class="max-w-4xl mx-auto">
                        <div id="detailed-topic-post" class="bg-white p-8 rounded-2xl shadow-2xl mb-8 border border-indigo-100">
                            <h1 id="detail-topic-title" class="text-4xl font-extrabold text-slate-900 mb-3">T√≠tulo do T√≥pico Detalhado</h1>
                            <div class="flex items-center space-x-3 text-sm text-slate-500 mb-6 border-b pb-4">
                                <span id="detail-topic-author" class="font-medium text-indigo-600">Por Autor</span>
                                <span id="detail-topic-time">√†s 00:00</span>
                                <span id="detail-topic-category" class="category-pill Geral">Categoria</span>
                            </div>

                            <div id="detail-topic-image-container" class="mb-6 hidden">
                                <img id="detail-topic-image" src="" alt="Imagem do T√≥pico" class="max-w-full rounded-lg shadow-lg border border-slate-200">
                            </div>

                            <p id="detail-topic-content" class="text-lg text-slate-700 leading-relaxed whitespace-pre-wrap">Conte√∫do completo aqui...</p>
                            
                        </div>

                        <h2 id="comments-count" class="text-2xl font-bold text-slate-800 mb-6">Coment√°rios (0)</h2>

                        <div id="comments-list" class="space-y-6 mb-8">
                            </div>
                        
                        <div class="bg-white p-6 rounded-xl shadow-lg border border-slate-200">
                            <h3 class="text-xl font-bold text-indigo-700 mb-4">Adicionar Coment√°rio</h3>
                            <form id="comment-form">
                                <input type="hidden" id="current-topic-id" value=""> 

                                <div class="mb-4">
                                    <textarea id="comment-content" rows="4" class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 shadow-sm" placeholder="Escreva seu coment√°rio aqui..." required></textarea>
                                </div>
                                <button type="submit" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-4 rounded-xl transition duration-300 primary-button">
                                    Comentar
                                </button>
                                <p id="comment-auth-message" class="text-center mt-3 text-red-500 font-medium hidden">Voc√™ deve estar logado para comentar.</p>
                            </form>
                        </div>
                    </div>
                </section>

                <section id="profile-content" class="content-section">
                    <h2 class="text-3xl font-extrabold mb-6 text-slate-900 border-b pb-2">Meu Perfil üë§</h2>
                    <div class="bg-white p-8 rounded-2xl shadow-xl flex flex-col md:flex-row items-center border border-indigo-100">
                        <img src="https://placehold.co/120x120/4f46e5/ffffff?text=U" alt="Placeholder de Usu√°rio" class="w-32 h-32 rounded-full object-cover mb-6 md:mb-0 md:mr-8 border-6 border-indigo-400 shadow-lg">
                        <div class="text-center md:text-left">
                            <h3 class="text-3xl font-extrabold text-slate-900 mb-1" id="profile-name">ISAC MIGUEL</h3>
                            <p class="text-indigo-600 font-medium text-lg">‚ú® Membro Ativo do F√≥rum</p>
                            <p class="text-slate-500 mt-3 max-w-lg italic">Bio: Este √© o seu perfil. Compartilhe sua paix√£o por tecnologia, design e desenvolvimento aqui!</p>
                            <div class="mt-6 flex flex-wrap justify-center md:justify-start space-x-6 text-base">
                                <span class="font-bold text-indigo-700" id="profile-post-count">0 Posts</span>
                                <span class="font-bold text-green-600">0 Respostas</span>
                                <span class="font-bold text-red-500">N√≠vel: Iniciante</span>
                            </div>
                        </div>
                    </div>
                </section>
                
                <section id="create-topic-content" class="content-section">
                    <h2 class="text-3xl font-extrabold mb-6 text-slate-900 border-b pb-2">Criar Novo T√≥pico ‚úçÔ∏è</h2>
                    <div class="bg-white p-8 rounded-2xl shadow-2xl max-w-3xl mx-auto border border-indigo-100">
                        <h3 class="text-2xl font-bold mb-8 text-center text-indigo-700">Compartilhe seu Conhecimento ou D√∫vida</h3>
                        <form id="create-topic-form">
                            <div class="mb-5">
                                <label for="topic-title" class="block text-base font-semibold text-slate-700 mb-2">T√≠tulo do T√≥pico <span class="text-red-500">*</span></label>
                                <input type="text" id="topic-title" name="title" class="w-full px-5 py-3 border border-slate-300 rounded-xl focus:ring-indigo-500 focus:border-indigo-500 shadow-sm" placeholder="Ex: D√∫vida sobre CSS Grid" required maxlength="100">
                            </div>
                            <div class="mb-5">
                                <label for="topic-category" class="block text-base font-semibold text-slate-700 mb-2">Categoria <span class="text-red-500">*</span></label>
                                <select id="topic-category" name="category" class="w-full px-5 py-3 border border-slate-300 rounded-xl focus:ring-indigo-500 focus:border-indigo-500 shadow-sm appearance-none" required>
                                    <option value="">Selecione uma Categoria</option>
                                    <option value="Programa√ß√£o Web" class="text-indigo-600">Programa√ß√£o Web üåê</option>
                                    <option value="Design UX/UI" class="text-green-600">Design UX/UI üé®</option>
                                    <option value="Intelig√™ncia Artificial" class="text-red-600">Intelig√™ncia Artificial ü§ñ</option>
                                    <option value="Geral">Geral üí¨</option>
                                </select>
                            </div>
                            <div class="mb-5">
                                <label for="topic-content" class="block text-base font-semibold text-slate-700 mb-2">Conte√∫do <span class="text-red-500">*</span></label>
                                <textarea id="topic-content" name="content" rows="8" class="w-full px-5 py-3 border border-slate-300 rounded-xl focus:ring-indigo-500 focus:border-indigo-500 shadow-sm" placeholder="Descreva sua d√∫vida ou assunto em detalhes..." required></textarea>
                            </div>

                            <div class="mb-8 p-4 bg-slate-50 border border-slate-200 rounded-xl">
                                <label for="topic-image" class="block text-base font-semibold text-slate-700 mb-2">Adicionar Imagem (Opcional)</label>
                                <input type="file" id="topic-image" name="image" accept="image/*" class="w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100 cursor-pointer"/>
                                <div class="mt-4 hidden" id="image-preview-container">
                                    <p class="text-sm font-medium text-slate-600 mb-2">Pr√©-visualiza√ß√£o:</p>
                                    <img id="image-preview" src="" alt="Pr√©-visualiza√ß√£o do t√≥pico" class="max-w-full max-h-48 rounded-lg shadow-md border border-slate-200 object-cover mx-auto"/>
                                </div>
                            </div>
                            <button type="submit" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-4 rounded-xl transition duration-300 ease-in-out transform hover:scale-[1.01] primary-button">
                                Publicar T√≥pico Agora!
                            </button>
                        </form>
                    </div>
                </section>
                
                <section id="login-content" class="content-section">
                    <h2 class="text-3xl font-extrabold mb-6 text-slate-900 border-b pb-2">Acesso √† Sua Conta üîë</h2>
                    <div class="bg-white p-10 rounded-2xl shadow-2xl max-w-lg mx-auto border border-indigo-100">
                        <h3 class="text-2xl font-bold mb-8 text-center text-indigo-700">Fa√ßa Login para Continuar</h3>
                        <form id="login-form" action="#" method="POST">
                            <div class="mb-5">
                                <label for="email" class="block text-sm font-medium text-slate-700 mb-2">E-mail</label>
                                <input type="email" id="email" name="email" class="w-full px-5 py-3 border border-slate-300 rounded-xl focus:ring-indigo-500 focus:border-indigo-500 shadow-sm" placeholder="teste@forum.com" required>
                            </div>
                            <div class="mb-6">
                                <label for="password" class="block text-sm font-medium text-slate-700 mb-2">Senha</label>
                                <input type="password" id="password" name="password" class="w-full px-5 py-3 border border-slate-300 rounded-xl focus:ring-indigo-500 focus:border-indigo-500 shadow-sm" placeholder="123456" required>
                            </div>
                            <button type="submit" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-4 rounded-xl transition duration-300 ease-in-out transform hover:scale-[1.01] primary-button">
                                Entrar na Conta
                            </button>
                        </form>
                        <p class="mt-6 text-center text-sm text-slate-500">
                            Ainda n√£o tem conta? 
                            <a href="#" data-target="register-content" class="switch-form-link text-green-600 hover:text-green-800 font-bold">Cadastre-se aqui.</a>
                        </p>
                    </div>
                </section>
                
                <section id="register-content" class="content-section">
                    <h2 class="text-3xl font-extrabold mb-6 text-slate-900 border-b pb-2">Crie sua Conta üìù</h2>
                    <div class="bg-white p-10 rounded-2xl shadow-2xl max-w-lg mx-auto border border-indigo-100">
                        <h3 class="text-2xl font-bold mb-8 text-center text-green-700">Junte-se √† Comunidade</h3>
                        <form id="register-form" action="#" method="POST">
                            <div class="mb-4">
                                <label for="reg-username" class="block text-sm font-medium text-slate-700 mb-2">Nome de Usu√°rio</label>
                                <input type="text" id="reg-username" name="username" class="w-full px-5 py-3 border border-slate-300 rounded-xl focus:ring-green-500 focus:border-green-500 shadow-sm" placeholder="Ex: isac_miguel" required>
                            </div>
                            <div class="mb-4">
                                <label for="reg-email" class="block text-sm font-medium text-slate-700 mb-2">E-mail</label>
                                <input type="email" id="reg-email" name="email" class="w-full px-5 py-3 border border-slate-300 rounded-xl focus:ring-green-500 focus:border-green-500 shadow-sm" placeholder="seu.email@exemplo.com" required>
                            </div>
                            <div class="mb-6">
                                <label for="reg-password" class="block text-sm font-medium text-slate-700 mb-2">Senha</label>
                                <input type="password" id="reg-password" name="password" class="w-full px-5 py-3 border border-slate-300 rounded-xl focus:ring-green-500 focus:border-green-500 shadow-sm" placeholder="M√≠nimo 6 caracteres" minlength="6" required>
                            </div>
                            <button type="submit" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-xl transition duration-300 ease-in-out transform hover:scale-[1.01] primary-button">
                                Registrar na Comunidade
                            </button>
                        </form>
                        <p class="mt-6 text-center text-sm text-slate-500">
                            J√° tem uma conta? 
                            <a href="#" data-target="login-content" class="switch-form-link text-indigo-600 hover:text-indigo-800 font-bold">Fa√ßa login.</a>
                        </p>
                    </div>
                </section>

            </section>

            <aside id="main-sidebar" class="lg:col-span-1 bg-white p-6 rounded-xl shadow-xl hidden lg:block h-fit sticky top-[7rem]"> 
                <h3 class="text-2xl font-bold text-gray-800 mb-4 border-b pb-2">Navega√ß√£o R√°pida</h3>
                <ul class="space-y-3">
                    <li><a data-target="home-content" class="nav-link text-gray-600 hover:text-indigo-600 transition font-medium flex items-center cursor-pointer">‚≠ê T√≥picos Recentes</a></li>
                    <li><a data-target="profile-content" class="nav-link text-gray-600 hover:text-indigo-600 transition font-medium flex items-center cursor-pointer">üë§ Meu Perfil</a></li>
                    <li><a data-target="create-topic-content" class="nav-link text-gray-600 hover:text-indigo-600 transition font-medium flex items-center cursor-pointer">‚ûï Novo T√≥pico</a></li>
                    <li><a data-target="login-content" class="nav-link text-gray-600 hover:text-indigo-600 transition font-medium flex items-center cursor-pointer">üîë Entrar/Sair</a></li>
                </ul>

                <div class="mt-8 pt-4 border-t border-slate-100">
                    <h4 class="font-bold text-lg text-indigo-700 mb-3">Categorias Populares</h4>
                    <ul class="text-sm space-y-2">
                        <li><span class="category-pill Programa√ß√£o-Web">Programa√ß√£o Web</span></li>
                        <li><span class="category-pill Design-UX/UI">Design UX/UI</span></li>
                        <li><span class="category-pill Intelig√™ncia-Artificial">Intelig√™ncia Artificial</span></li>
                        <li><span class="category-pill Geral">Geral</span></li>
                    </ul>
                </div>
            </aside>
            
        </div>
    </main>

    <footer class="bg-gray-800 text-white py-8 mt-auto">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center text-sm">
            
            <div class="mt-2 space-x-4">
                <a href="#" class="text-gray-400 hover:text-white">Privacidade</a>
                <a href="#" class="text-gray-400 hover:text-white">Termos de Uso</a>
            </div>
        </div>
    </footer>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const navLinks = document.querySelectorAll('.nav-link');
            const switchFormLinks = document.querySelectorAll('.switch-form-link');
            const contentSections = document.querySelectorAll('.content-section');
            const loginForm = document.getElementById('login-form');
            const registerForm = document.getElementById('register-form'); 
            const createTopicForm = document.getElementById('create-topic-form'); 
            const commentForm = document.getElementById('comment-form');
            const authButtons = document.getElementById('auth-buttons');
            const userInfo = document.getElementById('user-info');
            const logoutButton = document.getElementById('logout-button');
            const loggedUserName = document.getElementById('logged-user-name');
            const profileName = document.getElementById('profile-name');
            const profilePostCount = document.getElementById('profile-post-count'); 
            const topicsListContainer = document.getElementById('topics-list-container'); 
            
            // Vari√°veis de Imagem
            const topicImageInput = document.getElementById('topic-image');
            const imagePreview = document.getElementById('image-preview');
            const imagePreviewContainer = document.getElementById('image-preview-container');
    
            // Elementos da Detalhes do T√≥pico
            const detailTopicTitle = document.getElementById('detail-topic-title');
            const detailTopicAuthor = document.getElementById('detail-topic-author');
            const detailTopicTime = document.getElementById('detail-topic-time');
            const detailTopicCategory = document.getElementById('detail-topic-category');
            const detailTopicContent = document.getElementById('detail-topic-content');
            const detailTopicImage = document.getElementById('detail-topic-image');
            const detailTopicImageContainer = document.getElementById('detail-topic-image-container');
            const currentTopicIdInput = document.getElementById('current-topic-id');
            const commentsList = document.getElementById('comments-list');
            const commentsCountElement = document.getElementById('comments-count');
    
    
            // Vari√°vel de estado global
            let isUserLoggedIn = false;
            let currentUserName = 'Visitante';
            let userPostCount = 0; 
            let currentImageBase64 = null;
    
            // ==========================================================
            //  IN√çCIO DA IMPLEMENTA√á√ÉO DE RESTRI√á√ïES DE COMENT√ÅRIOS (IA de Filtro)
            // ==========================================================
    
            // ** 1. Lista de palavras e frases proibidas (Filtro de Seguran√ßa) **
            // Expandido para incluir xenofobia, xingamentos de baixo cal√£o e termos de √≥dio.
            const BANNED_WORDS = [
                // Termos de √≥dio e preconceito (xenofobia, racismo, homofobia, etc.)
                'racista', 'homofobico', 'xenofobia', 'preconceito', 'discriminacao', 'nazista', 'odeio', 'odio',
                'macaco', 'negroide', 'macaqueando', // Racismo
                'viado', 'bicha', 'sapat√£o', 'traveco', 'homossexual', // Homofobia/Transfobia (termos pejorativos)
                // Xenofobia/Regionalismo (quando usado de forma ofensiva)
                'gringo', 'estrangeiro', 'nordestino', 'sulista', 'nortista', 
                'retardado', 'mongol', 'aleijado', 'autista', // Capacitismo/Termos pejorativos de doen√ßa
                
                // Xingamentos de baixo cal√£o
                'puta', 'vagabundo', 'merda', 'cuz√£o', 'caralho', 'porra', 'fdp', 'foda-se', 'idiota',
                'imbecil', 'burro', 'otario', 'escroto', 'desgra√ßa', 'inferno', 'peste', 'boc√≥', 'babaca',
                'cabrao', 'filhodaputa', 'chupa', 'piranha', 'vaca', 'putaria', 'vergonha', 'trouxa',
                'cu', 'pau', 'rola', 'buceta', 'pinto', 'xoxota', 'punheta', // Sexualmente expl√≠cito ou baixo cal√£o
    
                // Amea√ßas e incita√ß√£o √† viol√™ncia
                'amea√ßa', 'matar', 'suicidio', 'bomba', 'ataque', 'violencia', 'fogo', 'explodir', 'morte' 
            ];
            
            // ** 2. Fun√ß√£o de Verifica√ß√£o de Seguran√ßa do Coment√°rio **
            function isCommentSafe(comment) {
                // Normaliza o coment√°rio (min√∫sculas, remove acentos e caracteres especiais para evitar truques)
                const normalizedComment = comment.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "").replace(/[^a-z0-9\s]/g, '');
    
                for (const word of BANNED_WORDS) {
                    // Verifica se a palavra proibida est√° contida no coment√°rio
                    if (normalizedComment.includes(word)) {
                        return false; // Conte√∫do inseguro encontrado
                    }
                }
                return true; // Conte√∫do seguro
            }
    
            // ==========================================================
            //  FIM DA IMPLEMENTA√á√ÉO DE RESTRI√á√ïES DE COMENT√ÅRIOS (IA de Filtro)
            // ==========================================================
    
            // Armazenamento simulado (Para o registro)
            const registeredUser = {
                username: 'USUARIO_TESTE',
                email: 'usuario@teste.com',
                password: 'password123'
            };
            
            // Simula√ß√£o de t√≥picos existentes
            const initialTopics = [
                { id: 1, title: "Qual a melhor IA para gera√ß√£o de c√≥digo?", author: "GPT F√£", category: "Intelig√™ncia Artificial", content: "Estou come√ßando e gostaria de saber se Copilot, Gemini ou CodeWhisperer tem a melhor curva de aprendizado. Para o meu projeto, preciso de algo que seja bom com JavaScript e Python.", image: '', 
                    comments: [{ author: "Dev S√™nior", content: "Eu recomendo o Copilot para JS/Python. Ele √© mais robusto na contextualiza√ß√£o de grandes bases de c√≥digo, mas o Gemini √© √≥timo para sugest√µes em tempo real.", time: "10:30" }] 
                },
                { id: 2, title: "Dicas para mobile-first Design", author: "UX Master", category: "Design UX/UI", content: "Quais s√£o as melhores pr√°ticas para garantir que um layout complexo funcione perfeitamente em telas pequenas? Estou tendo problemas com grids complexos no Breakpoint de 375px.", image: '', 
                    comments: [] 
                },
                { id: 3, title: "Entendendo o V8 Engine do JavaScript", author: "Dev J√∫nior", category: "Programa√ß√£o Web", content: "Algu√©m pode explicar de forma simples como o V8 otimiza o c√≥digo JavaScript para rodar mais r√°pido no Chrome? O que s√£o 'Hidden Classes'?", image: '', 
                    comments: [{ author: "Professor Web", content: "Em resumo, o V8 compila JS para c√≥digo de m√°quina em vez de interpret√°-lo. 'Hidden Classes' s√£o otimiza√ß√µes internas para acelerar a busca de propriedades em objetos JS, tornando-o mais pr√≥ximo do desempenho de linguagens tipadas.", time: "14:50" }] 
                }
            ];
            let nextTopicId = initialTopics.length + 1; // Contador para novos t√≥picos
    
    
            // Fun√ß√£o para carregar os t√≥picos iniciais
            function loadInitialTopics() {
                topicsListContainer.innerHTML = '';
                [...initialTopics].sort((a, b) => b.id - a.id).forEach(topic => {
                    createTopicElement(topic);
                });
            }
    
            // L√ìGICA DE PR√â-VISUALIZA√á√ÉO DE IMAGEM
            if (topicImageInput) {
                topicImageInput.addEventListener('change', function(event) {
                    const file = event.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            currentImageBase64 = e.target.result; 
                            imagePreview.src = currentImageBase64;
                            imagePreviewContainer.classList.remove('hidden');
                        };
                        reader.readAsDataURL(file);
                    } else {
                        currentImageBase64 = null;
                        imagePreview.src = '';
                        imagePreviewContainer.classList.add('hidden');
                    }
                });
            }
    
            // Fun√ß√µes auxiliares (feedback, navega√ß√£o, updateHeaderState, etc.)
            function getFeedbackElement(form) {
                let feedback = form.parentNode.querySelector('.feedback-message');
                if (!feedback) {
                    feedback = document.createElement('p');
                    feedback.className = 'text-center mt-4 font-medium text-sm feedback-message';
                    form.parentNode.appendChild(feedback);
                }
                return feedback;
            }
    
            function showMessage(element, text, isError = false) {
                element.textContent = text;
                element.classList.remove('text-green-600', 'text-red-600');
                element.classList.add(isError ? 'text-red-600' : 'text-green-600');
            }
    
            window.setActiveContent = function(targetId) { // Globalized for onclick in HTML
                contentSections.forEach(section => {
                    section.classList.remove('active');
                });
                // When we move sections into a single wrapper, we must ensure they are unhidden individually.
                // We must also hide all other sections that are not the target ID.
                contentSections.forEach(section => {
                    if (section.id === targetId) {
                        section.classList.add('active');
                        section.scrollIntoView({ behavior: 'smooth', block: 'start' }); 
                    } else {
                        section.classList.remove('active');
                    }
                });
            }

            window.setNavActiveByTarget = function(targetId) { // Globalized for onclick in HTML
                const targetLink = document.querySelector(`.nav-link[data-target="${targetId}"]`);
                const homeLink = document.querySelector('.nav-link[data-target="home-content"]');

                navLinks.forEach(link => {
                    link.classList.remove('text-indigo-700', 'font-bold', 'active-nav');
                    if (link.closest('#main-nav')) {
                        link.classList.add('text-slate-600');
                    }
                    if (link.closest('#main-sidebar ul')) {
                        link.classList.add('text-gray-600', 'hover:text-indigo-600');
                    }
                });

                if (targetLink) {
                    if (targetLink.closest('#main-nav')) {
                        targetLink.classList.remove('text-slate-600');
                        targetLink.classList.add('text-indigo-700', 'font-bold', 'active-nav');
                    }
                    if (targetLink.closest('#main-sidebar ul')) {
                        targetLink.classList.remove('text-gray-600');
                        targetLink.classList.add('text-indigo-600', 'font-bold');
                    }
                } else if (targetId === 'create-topic-content' || targetId === 'login-content' || targetId === 'register-content' || targetId === 'topic-detail-content') {
                    if (homeLink) {
                        homeLink.classList.remove('text-slate-600');
                        homeLink.classList.add('text-indigo-700', 'font-bold', 'active-nav');
                    }
                }
            }
    
            function updateHeaderState(loggedIn) {
                if (loggedIn) {
                    authButtons.classList.add('hidden');
                    userInfo.classList.remove('hidden');
                    loggedUserName.textContent = currentUserName.split(' ')[0];
                    profileName.textContent = currentUserName;
                    profilePostCount.textContent = `${userPostCount} Posts`;
                    document.getElementById('create-topic-button').classList.remove('hidden');
                    
                    // Exibe o formul√°rio de coment√°rio para usu√°rios logados
                    const commentButton = document.querySelector('#comment-form button[type="submit"]');
                    const authMsg = document.getElementById('comment-auth-message');
                    if (commentButton && authMsg) {
                        commentButton.classList.remove('hidden');
                        authMsg.classList.add('hidden');
                    }
                } else {
                    authButtons.classList.remove('hidden');
                    userInfo.classList.add('hidden');
                    currentUserName = 'Visitante';
                    userPostCount = 0;
                    profileName.textContent = 'ISAC MIGUEL'; 
                    profilePostCount.textContent = '0 Posts';
                    document.getElementById('create-topic-button').classList.add('hidden');
                    
                    // Esconde o formul√°rio de coment√°rio e mostra a mensagem de login
                    const commentButton = document.querySelector('#comment-form button[type="submit"]');
                    const authMsg = document.getElementById('comment-auth-message');
                    if (commentButton && authMsg) {
                        commentButton.classList.add('hidden');
                        authMsg.classList.remove('hidden');
                    }
                }
            }
    
            function createCommentElement(comment) {
                const commentDate = new Date();
                const commentTime = commentDate.getHours().toString().padStart(2, '0') + ':' + commentDate.getMinutes().toString().padStart(2, '0');
                
                return `
                    <div class="p-4 bg-slate-50 rounded-lg border border-slate-200">
                        <div class="flex items-center mb-2">
                            <img src="https://placehold.co/32x32/334155/ffffff?text=${comment.author.substring(0, 1)}" alt="Avatar" class="w-8 h-8 rounded-full mr-3 border border-slate-300">
                            <div>
                                <p class="font-bold text-slate-800">${comment.author}</p>
                                <p class="text-xs text-slate-500">${commentTime}</p>
                            </div>
                        </div>
                        <p class="text-sm text-slate-700 ml-11">${comment.content}</p>
                    </div>
                `;
            }
    
            function renderComments(topic) {
                commentsList.innerHTML = '';
                if (topic.comments.length === 0) {
                    commentsList.innerHTML = '<p class="text-center text-slate-500 italic">Seja o primeiro a comentar neste t√≥pico!</p>';
                } else {
                    topic.comments.forEach(comment => {
                        commentsList.insertAdjacentHTML('beforeend', createCommentElement(comment));
                    });
                }
                commentsCountElement.textContent = `Coment√°rios (${topic.comments.length})`;
            }
    
            window.showTopicDetail = function(topicId) {
                const topic = initialTopics.find(t => t.id === topicId);
                
                if (!topic) {
                    alert('T√≥pico n√£o encontrado!');
                    return;
                }
    
                // Preenche os dados do t√≥pico
                detailTopicTitle.textContent = topic.title;
                detailTopicAuthor.textContent = `Por ${topic.author}`;
                detailTopicContent.textContent = topic.content;
                currentTopicIdInput.value = topic.id;
                
                // Categoria e Cor
                detailTopicCategory.textContent = topic.category;
                detailTopicCategory.className = `category-pill ${topic.category.replace(/ /g, '-').replace(/\//g, '')}`;
    
                // Imagem
                if (topic.image) {
                    detailTopicImage.src = topic.image;
                    detailTopicImageContainer.classList.remove('hidden');
                } else {
                    detailTopicImage.src = '';
                    detailTopicImageContainer.classList.add('hidden');
                }
                
                // Coment√°rios
                renderComments(topic);
                
                // Navega para a se√ß√£o
                setActiveContent('topic-detail-content');
                setNavActiveByTarget('topic-detail-content');
                
                // Atualiza estado de login para o formul√°rio de coment√°rio
                updateHeaderState(isUserLoggedIn);
            }
    
            function createTopicElement(topic) {
                const categoryClass = topic.category.replace(/ /g, '-').replace(/\//g, '');
                let borderColor = '';
    
                switch (topic.category) {
                    case 'Programa√ß√£o Web':
                        borderColor = 'border-indigo-500';
                        break;
                    case 'Design UX/UI':
                        borderColor = 'border-emerald-500';
                        break;
                    case 'Intelig√™ncia Artificial':
                        borderColor = 'border-red-500';
                        break;
                    default:
                        borderColor = 'border-gray-500';
                        break;
                }
    
                const now = new Date();
                const hours = now.getHours().toString().padStart(2, '0');
                const minutes = now.getMinutes().toString().padStart(2, '0');
                const timeStr = `${hours}:${minutes}`;
                
                const imageBlock = topic.image ? 
                    `<div class="mt-4 mb-3 border-t pt-3 border-slate-100">
                        <img src="${topic.image}" alt="Imagem do t√≥pico" class="max-w-full max-h-40 rounded-lg shadow-sm object-cover" />
                    </div>` : '';
    
                const newTopicHtml = `
                    <div onclick="showTopicDetail(${topic.id})" class="cursor-pointer bg-white p-5 rounded-xl shadow-lg border-l-4 ${borderColor} flex justify-between items-start hover:shadow-xl hover:translate-y-[-2px] transition duration-200 ease-in-out animate-fadeIn" style="animation-delay: 0.1s;">
                        <div>
                            <a href="#" class="text-lg font-bold text-slate-900 hover:text-indigo-600 transition">${topic.title}</a>
                            <p class="text-sm text-slate-500 mt-1">por <span class="font-medium text-indigo-600">${topic.author}</span> √†s ${timeStr}</p>
                            ${imageBlock} 
                            <p class="text-sm text-slate-700 mt-2 line-clamp-2">${topic.content.substring(0, 100)}...</p>
                            <div class="mt-3 text-xs flex space-x-3 text-slate-500">
                                <span class="font-medium">${topic.comments.length} Respostas</span>
                                <span class="font-medium">1 Visualiza√ß√£o</span>
                            </div>
                            <span class="category-pill ${categoryClass} mt-3">${topic.category}</span>
                        </div>
                    </div>
                `;
                
                topicsListContainer.insertAdjacentHTML('afterbegin', newTopicHtml);
            }
    
    
            // L√≥gica de Submiss√£o de CRIA√á√ÉO DE T√ìPICO
            if (createTopicForm) {
                createTopicForm.addEventListener('submit', (event) => {
                    event.preventDefault();
                    
                    if (!isUserLoggedIn) {
                        alert("Voc√™ deve estar logado para criar um t√≥pico!");
                        return;
                    }
    
                    const title = document.getElementById('topic-title').value.trim();
                    const category = document.getElementById('topic-category').value;
                    const content = document.getElementById('topic-content').value.trim();
                    
                    if (!title || !category || !content) {
                        alert("Preencha todos os campos obrigat√≥rios do t√≥pico.");
                        return;
                    }
    
                    const newTopic = {
                        id: nextTopicId++,
                        title: title,
                        author: currentUserName,
                        category: category,
                        content: content,
                        image: currentImageBase64,
                        comments: []
                    };
                    initialTopics.push(newTopic);
                    
                    createTopicElement(newTopic);
    
                    userPostCount++;
                    profilePostCount.textContent = `${userPostCount} Posts`;
    
                    createTopicForm.reset();
                    currentImageBase64 = null;
                    imagePreview.src = '';
                    imagePreviewContainer.classList.add('hidden');
                    
                    alert(`T√≥pico "${title}" publicado com sucesso!`);
                    
                    setActiveContent('home-content');
                    setNavActiveByTarget('home-content');
                });
            }
            
            // L√≥gica de Submiss√£o de COMENT√ÅRIO (Com a Restri√ß√£o Implementada)
            if (commentForm) {
                commentForm.addEventListener('submit', (event) => {
                    event.preventDefault();
    
                    if (!isUserLoggedIn) {
                        alert("Voc√™ deve estar logado para comentar!");
                        return;
                    }
                    
                    const topicId = parseInt(currentTopicIdInput.value);
                    const commentContent = document.getElementById('comment-content').value.trim();
    
                    if (!commentContent) {
                        alert("O coment√°rio n√£o pode estar vazio.");
                        return;
                    }
                    
                    // ** APLICA√á√ÉO DA RESTRI√á√ÉO DE CONTE√öDO **
                    if (!isCommentSafe(commentContent)) {
                        alert("üö´ Conte√∫do Bloqueado pelo Filtro de Seguran√ßa (IA): O seu coment√°rio cont√©m termos de baixo cal√£o, ofensas, xenofobia ou incita√ß√£o ao √≥dio. Por favor, revise e utilize uma linguagem respeitosa.");
                        return; // IMPEDE A PUBLICA√á√ÉO
                    }
                    // ** FIM DA APLICA√á√ÉO DA RESTRI√á√ÉO **
    
    
                    const topic = initialTopics.find(t => t.id === topicId);
    
                    if (topic) {
                        const newComment = {
                            author: currentUserName,
                            content: commentContent,
                        };
                        
                        topic.comments.push(newComment);
                        
                        renderComments(topic);
                        
                        document.getElementById('comment-content').value = '';
                        alert("Coment√°rio adicionado com sucesso!");
                    }
                });
            }
    
    
            // L√≥gica de navega√ß√£o, login, cadastro e logout (mantidas do c√≥digo anterior)
            navLinks.forEach(link => {
                link.addEventListener('click', (event) => {
                    event.preventDefault(); 
                    const targetId = event.currentTarget.getAttribute('data-target');
                    if ((targetId === 'profile-content' || targetId === 'create-topic-content') && !isUserLoggedIn) {
                        const feedbackElement = getFeedbackElement(loginForm);
                        showMessage(feedbackElement, "Voc√™ precisa fazer login para acessar esta funcionalidade.", true);
                        setActiveContent('login-content');
                        setNavActiveByTarget('login-content');
                        return; 
                    }
                    document.querySelectorAll('.feedback-message').forEach(el => el.textContent = '');
                    setActiveContent(targetId);
                    setNavActiveByTarget(targetId);
                });
            });
    
            switchFormLinks.forEach(link => {
                link.addEventListener('click', (event) => {
                    event.preventDefault();
                    const targetId = event.currentTarget.getAttribute('data-target');
                    document.querySelectorAll('.feedback-message').forEach(el => el.textContent = '');
                    setActiveContent(targetId);
                    setNavActiveByTarget(targetId);
                });
            });
    
            if (registerForm) {
                registerForm.addEventListener('submit', (event) => {
                    event.preventDefault();
                    const feedbackElement = getFeedbackElement(registerForm);
                    const username = document.getElementById('reg-username').value.trim();
                    const email = document.getElementById('reg-email').value.trim();
                    const password = document.getElementById('reg-password').value.trim();
                    if (!username || !email || !password || password.length < 6) {
                        showMessage(feedbackElement, "Verifique todos os campos. Senha precisa de 6+ caracteres.", true);
                        return;
                    }
                    registeredUser.username = username.toUpperCase();
                    registeredUser.email = email;
                    registeredUser.password = password;
                    currentUserName = username.toUpperCase();
                    isUserLoggedIn = true;
                    userPostCount = 0; 
                    updateHeaderState(isUserLoggedIn);
                    showMessage(feedbackElement, `Cadastro conclu√≠do! Redirecionando para o perfil...`, false);
                    setTimeout(() => {
                        setActiveContent('profile-content');
                        setNavActiveByTarget('profile-content'); 
                        feedbackElement.textContent = ''; 
                    }, 1000);
                });
            }
    
            if (loginForm) {
                loginForm.addEventListener('submit', (event) => {
                    event.preventDefault();
                    const feedbackElement = getFeedbackElement(loginForm);
                    const email = document.getElementById('email').value.trim();
                    const password = document.getElementById('password').value.trim();
                    const isRegisteredMatch = email === registeredUser.email && password === registeredUser.password;
                    const isDefaultMatch = email === "teste@forum.com" && password === "123456";
                    
                    if (isRegisteredMatch || isDefaultMatch) {
                        currentUserName = isRegisteredMatch ? registeredUser.username : email.split('@')[0].toUpperCase();
                        isUserLoggedIn = true;
                        userPostCount = isDefaultMatch ? 3 : userPostCount; 
                        updateHeaderState(isUserLoggedIn);
                        showMessage(feedbackElement, `Login bem-sucedido! Redirecionando para o perfil...`, false);
                        setTimeout(() => {
                            setActiveContent('profile-content');
                            setNavActiveByTarget('profile-content');
                            feedbackElement.textContent = ''; 
                        }, 1000);
                    } else {
                        showMessage(feedbackElement, "E-mail ou senha incorretos.", true);
                    }
                });
            }
    
            if (logoutButton) {
                logoutButton.addEventListener('click', () => {
                    isUserLoggedIn = false;
                    currentUserName = 'Visitante';
                    userPostCount = 0;
                    updateHeaderState(isUserLoggedIn);
                    setActiveContent('home-content');
                    setNavActiveByTarget('home-content');
                });
            }
    
            // Inicializa√ß√£o
            updateHeaderState(isUserLoggedIn);
            const initialLink = document.querySelector('.nav-link[data-target="home-content"]');
            if (initialLink) {
                setNavActiveByTarget('home-content'); // Define o estado ativo de navega√ß√£o
                setActiveContent('home-content'); // Exibe o conte√∫do de in√≠cio
            }
            loadInitialTopics();
        });
    </script>
</body>
</html>
